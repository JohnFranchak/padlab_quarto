---
title: "Publications"
execute:
  echo: false
  warning: false
---

```{r}
#|output: false
#|echo: false
library(reactable)
library(tidyverse)
library(htmltools)
library(reactablefmtr)
refs <- read_csv("publications/publications.csv")
```

```{r}
refs_clean <- refs %>% 
  mutate(citation = sprintf("%s (%d). %s %s.", authors, year, title, venue), .after = url) %>% 
  select(-abstract, -editors, -numbers, -title, -venue) %>% 
  relocate(type, .after = citation)
         
reactable(refs_clean, 
          filterable = TRUE, 
          searchable = TRUE, 
          defaultSorted = c("year", "authors"), defaultSortOrder = "desc", 
          elementId = "cars-select", 
          theme = no_lines(font_size = 18),
          defaultColDef = colDef(show = FALSE, name = ""),
          columns = list(
              citation = colDef(show = TRUE, minWidth = 350, filterable = FALSE, 
                                details = function(index) {
                                  paste("Abstract: ", refs[index, "abstract"])
                                  }),
              url = colDef(maxWidth = 20, show = TRUE, filterable = FALSE, cell = function(value, index) {
                url <- sprintf("publications/%s", refs[index, "url"])
                htmltools::tags$a(href = url, target = "_blank", '\U2193')
              }),
          type = colDef(maxWidth = 105, show = TRUE,
            filterInput = function(values, name) {
            tags$select(
            # Set to undefined to clear the filter
            onchange = sprintf("Reactable.setFilter('cars-select', '%s', event.target.value || undefined)", name),
            # "All" has an empty value to clear the filter, and is the default option
            tags$option(value = "", "All"),
            lapply(unique(values), tags$option),
            "aria-label" = sprintf("Filter %s", name),
            style = "width: 100%; height: 28px;"
          )}
    )
  ))
```